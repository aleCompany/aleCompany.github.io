---
layout: single
title:  "이산형 확률분포"
categories: statistics
tag: [이산형 확률분포]
toc: true
author_profile: false
---

### 베르누이 분포

* 베르누이 시행
* 다음과 같은 시행(실험)을 베르누이 시행(Bernoulli trial)이라고 한다
  * 시행 결과가 두 가지 (성공, 실패) 중 하나인 경우
  * 각 시행에서 성공의 확률은 (항상 일정한) p 이다.
  * 각 시행은 서로 독립이다. (예제)
    * 동전 앞면성공, 뒷면 실패
   $$f(x) = \left\{\begin{matrix} 1/2 , x= 0 \\ 1/2 , x= 1 \\  \end{matrix}\right.$$      
    * 빨간공7,검정공3개에서 검정공이면 성공/빨강이면 실패 등
     $$f(x) = \left\{\begin{matrix} 3/10 , x= 1 \\ 7/10 , x= 0 \\  \end{matrix}\right.$$      
* 분포의 특징
  * 확률함수 
   $$f(x) = \left\{\begin{matrix}1-p, x= 0 \\ p, x= 1 \\ 0, 나머지 \\ \end{matrix}\right.$$
  * 기대값 $E(X) = 0 \times (1-p) + 1 \times p = p$
  * 분산 $Var(X) = (0-p)^2\times(1-p)+(1-p)^2\times p=p(1-p)$

* 분포관련 R 표현
  ```
    # 예제1) 빨간공 7개, 검정공3개에서 검정공이면 성공인 확률분포
    > x = 0:1; p=1-3/10
    > cy = rep(0, length(x) )  # 초기화
    > 
    > # pdf
    > py = c(p, 1-p)
    > plot(x, py,xlab="x", ylab="p(x)", type='h', lwd = 3, main="pdf", xaxt="n" )
    > axis(side=1, at= x )

    > # cdf = pdf 의 합 (PDF->CDF 일반화)
    > for( i in 1:length(x) ) { 
    +     if ( i == 1 ) {
    +         cy[i] = py[i]
    +     } else {
    +         for( j in 1:i ) {
    +             cy[i] =cy[i] + py[j]
    +         }
    +     }  
    + }
    > plot(x,cy,xlab="X", ylab="F(X)=P(X≤x)", lwd = 3, pch=16, main="cdf")
    > for(i in x) { lines(c( x[i+1],x[i+2]), c(cy[i+1],cy[i+1]) )  }
    
  ```

  <center><img src="../../images/2022-03-16-bindist/pic-4.png" /></center>  

### 이항분포

* 확률변수 X의 정의
  * 독립적인 베르누이 실험을 여러 번 (𝒏 번) 시도하여 **성공 사건이 발생한 횟수** $(𝒙 ≤ n )$
  * **이항분포는 여러번(n번) 베르누이 시행한것과 동일하다**
  * $X \sim B(n,p)$로 표기
* 분포의 특징
  * 확률함수 
   $$f(x) = \left\{\begin{matrix} \binom{n}{x}p^x(1-p)^{(n-x)},  x= 0,1,2...,n \\ 0, 나머지 \end{matrix}\right.$$
  * 기대값 $E(X) = E(X_1+X_2+...+X_n) = np$
  * 분산 $Var(X) = Var(X_1)+Var(X_2)+...+Var(X_n)=np(1-p)$

* 분포관련 R 함수

  <table>
    <thead>
      <tr><th>내용</th><th>형식</th></tr>
    </thead>
    <tbody>
      <tr><td>밀도함수</td><td>dbinom(x,size,prob)</td></tr>    
      <tr><td>누적분포함수</td><td>pbinom(x,size,prob,lower.tail=TRUE)</td></tr>    
      <tr><td>분위수함수</td><td>qbinom(x,size,prob,lower.tail=TRUE)</td></tr>    
      <tr><td>난수발생</td><td>rbinom(x,size,prob)</td></tr>                      
    </tbody>
  </table>
  ※ size : 베르누이 시행 횟수, prob는 성공확률 ,
     lower.tail	logical; if TRUE (default), probabilities are P[X ≤ x], otherwise, P[X > x]

  * R 예제
  ```
    # 예제1) 동전을 10번 던저 앞면이 나올 횟수의 확률분포(n=10, p=1/2) PDF,CDF
    > x =0:10; n = 10; p = 1/2
    # PDF
    > py = dbinom(x,n,p) 
    > plot(x, py,xlab="x", ylab="p(x)", type='h', lwd = 3, main="pdf") 
    # CDF
    > cy = pbinom(x,n,p) # CDF
    > plot(x,cy,xlab="X", ylab="F(X)=P(X≤x)", lwd = 3, pch=16, main="cdf")
    > for(i in x) { lines(c( x[i+1],x[i+2]), c(cy[i+1],cy[i+1]) )  }
  ```
  <center><img src="../../images/2022-03-16-bindist/pic-2.png" /></center>  

  ```
    # 예제2) 주사위를 6번던져 2가 나올 횟수의 확률분포 (n=6, p=1/6) PDF,CDF
    > x =0:6; n = 6; p = 1/6
    # PDF
    > py = dbinom(x,n,p) 
    > plot(x, py,xlab="x", ylab="p(x)", type='h', lwd = 3, main="pdf")
    # CDF
    > cy = pbinom(x,n,p) # CDF
    >  plot(x,cy,xlab="X", ylab="F(X)=P(X≤x)", lwd = 3, pch=16, main="cdf")
    > for(i in x) { lines(c( x[i+1],x[i+2]), c(cy[i+1],cy[i+1]) )  }
  ```
  <center><img src="../../images/2022-03-16-bindist/pic-3.png" /></center>  

### 초기하 분포

* 확률변수 X의 정의
  * 하얀 공 a개 검은 공 b개가 있는 주머니에서, n개의 공을 꺼냈을 경우, n개의 공에서 하얀 공의 수
  * 초기하 분포는 하나를 꺼내고 나면, 뒤에 사건에 영향을 주는 독립시행이 아니기 때문에 이항과 베르누이 시행과 구분이 되어야 한다. (독립조건이 깨어짐)
  
* 분포의 특징
  * 확률함수 
    $$f(x) = \left\{\begin{matrix} \frac {\binom{a}{x}\binom{b}{n-x}} {\binom{a+b}{n}},  x= 0,1,2...,n (n \le a) \\ 0, 나머지\end{matrix}\right.$$
  * 기대값 $E(X) = n \times \frac{a}{a+b}$
  * 분산 $Var(X) = \frac{a+b-n}{a+b-1} [ n \times \frac{a}{a+b} \times \frac{b}{a+b} ]$ 


### 포아송 분포

* 확률변수 X의 정의
  * 일정한 **시간이나 공간**에서 특정 사건이 발생 횟수 (이항과의 차이는 n이 거의 무한대)
  * 예)
    * 일본에서 1년 동안 발생한 진도 4 이상의 지진 횟수
    * 1년 동안 발생한 위암 환자 수
    * 1시간 동안 콜센터에 걸려오는 전화 횟수
    * 1m 길이의 정사각형 나무 판자에서 발견된 흠집의 수
  
* 포아송 분포의 조건
  * 짧은 구간에서 사건이 2번 이상 발생할 확률은 0에 가까움
  * 정해진 구간에서 사건이 발생할 확률은 **구간의 길이에 비례**
  * 서로 겹치지 않는 두 구간에서 발생하는 **사건의 수는 서로 독립**
  
* 분포의 특징
  * 확률함수 (**평균을 람다로 표기하고, 구간에서 발생하는 횟수를 의미**)
    $$f(x) = \left\{\begin{matrix}\ \frac {e^{-\lambda} \lambda^{x}}{x!} ,  x= 0,1,2... \\ 0, 나머지\end{matrix}\right.$$
  * 기대값 $E(X) =\lambda$
  * 분산 $Var(X) = \lambda$ 
  
* 분포관련 R 함수

  |내용|형식|
  |-|-|
  |밀도함수|dpois(x, lambda)|
  |누적분포함수|ppois(q=x, lambda, lower.tail = TRUE)|
  |분위수함수|qpois(p=x, lambda, lower.tail = TRUE)|
  |난수발생|rpois(x,lambda)|
  
  ※ lambda : 일정시간,공간에서 발생하는 사건 회수


* R 예제
  ```
  # 람다가 3인 포아송 분포
  > x = 0:10; lambda=3
  > 
  > # pdf
  > py = dpois(x,lambda) # PDF
  > plot(x, py,xlab="x", ylab="p(x)", type='h', lwd = 3, main="pdf")
  > # pdf
  > py = dpois(x,lambda) # PDF
  > plot(x, py,xlab="x", ylab="p(x)", type='h', lwd = 3, main="pdf")
  > cy = ppois(q=x, lambda) # CDF
  > plot(x,cy,xlab="X", ylab="F(X)=P(X≤x)", lwd = 3, pch=16, main="cdf")
  > for(i in x) { lines(c( x[i+1],x[i+2]), c(cy[i+1],cy[i+1]) )  }
  ``` 

  <center><img src="../../images/2022-03-16-bindist/pic-5.png"></center>  

### 포아송 분포와 이항분포와의 관계

* 만일 확률변수 Y를 1분에 발생하는 사건의 수이고, Y는 평균 횟수 λ 인 포아송 분포를 따른다 고 하자. ($Y\sim P(\lambda)$)
* 구간을 충분히 큰 n으로 나누고, 확률변수 X를 나눈 구간에서 발생한 사건의 수라고 하면 각 구간은 평균 λ /n 의 포아송 분포를 따르게 된다 ($X\sim P(\lambda / n)$)
* 이는  또한 또한 이항분포와 동일한 상황이 된다. $X\sim B(n,λ /n)$
* n이 충분히 크고 p가 작은 이항분포는 포아송 분포를 근사한다
  
  <center><img src="../../images/2022-03-16-bindist/pic-1.png" style="width:50%;height:50%"/></center>


  > **n이 한번 베르누이, 여러번 이항분포, 무한대 포아송**

